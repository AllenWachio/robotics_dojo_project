# ğŸ¨ VISUAL SYSTEM ARCHITECTURE

## ğŸ“ System Overview Diagram

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                         COMPETITION ROBOT                         â•‘
â•‘                      Split Architecture                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ¤– RASPBERRY PI (Robot)                        â”‚
â”‚                      Hardware Layer                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Arduino    â”‚  â”‚  LiDAR   â”‚  â”‚ Camera â”‚  â”‚ TF Publisher â”‚   â”‚
â”‚  â”‚   Bridge    â”‚  â”‚  Driver  â”‚  â”‚  Node  â”‚  â”‚    (URDF)    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚              â”‚              â”‚              â”‚            â”‚
â”‚         â”œâ”€ /odom       â”œâ”€ /scan       â”œâ”€ /image     â”œâ”€ /tf      â”‚
â”‚         â”œâ”€ /imu/data   â”‚              â”‚              â”‚            â”‚
â”‚         â”œâ”€ /color_sensor/rgb          â”‚              â”‚            â”‚
â”‚         â”‚              â”‚              â”‚              â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                         â”‚ ROS2 Network                             â”‚
â”‚                         â†“ (Topics published)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ WiFi/Ethernet
                            â”‚ (Automatic DDS discovery)
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ’» LAPTOP (Base Station)                       â”‚
â”‚                    Processing Layer                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—  â”‚
â”‚  â•‘              ğŸŒ³ BEHAVIOR TREE (Main Brain)                 â•‘  â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£  â”‚
â”‚  â•‘                                                            â•‘  â”‚
â”‚  â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘  â”‚
â”‚  â•‘  â”‚  Phase 1: Disease Detection                      â”‚     â•‘  â”‚
â”‚  â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â•‘  â”‚
â”‚  â•‘  â”‚  â”‚ Navigate   â”‚â†’ â”‚ Run ML    â”‚â†’ â”‚ Return     â”‚  â”‚     â•‘  â”‚
â”‚  â•‘  â”‚  â”‚ to Plant   â”‚  â”‚ Inference â”‚  â”‚ Home       â”‚  â”‚     â•‘  â”‚
â”‚  â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â•‘  â”‚
â”‚  â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘  â”‚
â”‚  â•‘                                                            â•‘  â”‚
â”‚  â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘  â”‚
â”‚  â•‘  â”‚  Phase 2: Cargo Loading                          â”‚     â•‘  â”‚
â”‚  â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â•‘  â”‚
â”‚  â•‘  â”‚  â”‚ Navigate   â”‚â†’ â”‚ Reverse   â”‚â†’ â”‚ Read Color â”‚  â”‚     â•‘  â”‚
â”‚  â•‘  â”‚  â”‚ to Bay     â”‚  â”‚ Into Bay  â”‚  â”‚ Sensor     â”‚  â”‚     â•‘  â”‚
â”‚  â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â•‘  â”‚
â”‚  â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘  â”‚
â”‚  â•‘                                                            â•‘  â”‚
â”‚  â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘  â”‚
â”‚  â•‘  â”‚  Phase 3: Maze Navigation                        â”‚     â•‘  â”‚
â”‚  â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚     â•‘  â”‚
â”‚  â•‘  â”‚  â”‚ Navigate   â”‚âˆ¥ â”‚ Monitor   â”‚                   â”‚     â•‘  â”‚
â”‚  â•‘  â”‚  â”‚ to Deliveryâ”‚âˆ¥ â”‚ Camera    â”‚ (Parallel)        â”‚     â•‘  â”‚
â”‚  â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚     â•‘  â”‚
â”‚  â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘  â”‚
â”‚  â•‘                                                            â•‘  â”‚
â”‚  â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘  â”‚
â”‚  â•‘  â”‚  Phase 4: Cargo Delivery                         â”‚     â•‘  â”‚
â”‚  â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â•‘  â”‚
â”‚  â•‘  â”‚  â”‚ Reverse    â”‚â†’ â”‚ Activate  â”‚â†’ â”‚ Reset      â”‚  â”‚     â•‘  â”‚
â”‚  â•‘  â”‚  â”‚ Into Bay   â”‚  â”‚ Conveyor  â”‚  â”‚ Robot      â”‚  â”‚     â•‘  â”‚
â”‚  â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â•‘  â”‚
â”‚  â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘  â”‚
â”‚  â•‘                                                            â•‘  â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                            â†“                                       â”‚
â”‚                            â†“ (Uses these subsystems)               â”‚
â”‚                            â†“                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   Nav2       â”‚  â”‚  ML Models   â”‚  â”‚  Vision Processing  â”‚    â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚                     â”‚    â”‚
â”‚  â”‚ â€¢ AMCL       â”‚  â”‚ â€¢ Disease    â”‚  â”‚ â€¢ Color Detection  â”‚    â”‚
â”‚  â”‚ â€¢ Planner    â”‚  â”‚   Detection  â”‚  â”‚   (OpenCV HSV)     â”‚    â”‚
â”‚  â”‚ â€¢ Controller â”‚  â”‚   (TF/PyT)   â”‚  â”‚ â€¢ HSV Filtering    â”‚    â”‚
â”‚  â”‚ â€¢ Costmap    â”‚  â”‚              â”‚  â”‚ â€¢ Contour Finding  â”‚    â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                 â”‚                     â”‚                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                           â”‚                                        â”‚
â”‚                           â†“ (Publishes commands)                   â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Published Topics:                                          â”‚  â”‚
â”‚  â”‚  â€¢ /cmd_vel         â†’ Velocity commands                    â”‚  â”‚
â”‚  â”‚  â€¢ /camera_servo    â†’ Camera pan                           â”‚  â”‚
â”‚  â”‚  â€¢ /tipper_servo    â†’ Robot tilt                           â”‚  â”‚
â”‚  â”‚  â€¢ /conveyor        â†’ Belt control                         â”‚  â”‚
â”‚  â”‚  â€¢ /navigate_to_pose â†’ Nav2 goals                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Subscribed Topics:                                         â”‚  â”‚
â”‚  â”‚  â€¢ /odom            â† Odometry                             â”‚  â”‚
â”‚  â”‚  â€¢ /scan            â† LiDAR data                           â”‚  â”‚
â”‚  â”‚  â€¢ /image_raw       â† Camera feed                          â”‚  â”‚
â”‚  â”‚  â€¢ /color_sensor    â† RGB values                           â”‚  â”‚
â”‚  â”‚  â€¢ /amcl_pose       â† Robot position                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  RViz Visualization:                                        â”‚  â”‚
â”‚  â”‚  â€¢ Map display                                              â”‚  â”‚
â”‚  â”‚  â€¢ Robot model                                              â”‚  â”‚
â”‚  â”‚  â€¢ Planned paths                                            â”‚  â”‚
â”‚  â”‚  â€¢ Costmaps                                                 â”‚  â”‚
â”‚  â”‚  â€¢ Sensor data                                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Autonomy Loop

```
START
  â”‚
  â”œâ”€â†’ [Behavior Tree Tick] (every 0.5s)
  â”‚       â”‚
  â”‚       â”œâ”€â†’ Check current behavior status
  â”‚       â”‚
  â”‚       â”œâ”€â†’ Is it RUNNING?
  â”‚       â”‚   â”œâ”€ YES â†’ Read sensor topics
  â”‚       â”‚   â”‚         â”œâ”€ /amcl_pose (where am I?)
  â”‚       â”‚   â”‚         â”œâ”€ /scan (any obstacles?)
  â”‚       â”‚   â”‚         â”œâ”€ /color_sensor/rgb (what color?)
  â”‚       â”‚   â”‚         â””â”€ /camera/color_detection (zone color?)
  â”‚       â”‚   â”‚
  â”‚       â”‚   â””â”€ Update behavior state
  â”‚       â”‚       â”œâ”€ Distance to goal?
  â”‚       â”‚       â”œâ”€ Color detected?
  â”‚       â”‚       â”œâ”€ ML inference done?
  â”‚       â”‚       â””â”€ Return: RUNNING | SUCCESS | FAILURE
  â”‚       â”‚
  â”‚       â”œâ”€â†’ Is it SUCCESS?
  â”‚       â”‚   â””â”€ YES â†’ Move to next behavior
  â”‚       â”‚
  â”‚       â””â”€â†’ Is it FAILURE?
  â”‚           â””â”€ YES â†’ Try fallback or report error
  â”‚
  â”œâ”€â†’ [Nav2 Loop] (continuous)
  â”‚       â”‚
  â”‚       â”œâ”€â†’ Receive goal from behavior tree
  â”‚       â”œâ”€â†’ Plan path (avoid obstacles)
  â”‚       â”œâ”€â†’ Execute path (DWB controller)
  â”‚       â”œâ”€â†’ Publish /cmd_vel â†’ Pi
  â”‚       â””â”€â†’ Pi moves robot â†’ publishes /odom
  â”‚               â”‚
  â”‚               â””â”€â†’ Nav2 reads /odom, adjusts path
  â”‚
  â””â”€â†’ [Sensor Loop] (continuous)
          â”‚
          â”œâ”€â†’ Pi reads hardware
          â”œâ”€â†’ Pi publishes topics
          â”œâ”€â†’ Laptop processes topics
          â”‚   â”œâ”€ AMCL: updates robot pose
          â”‚   â”œâ”€ Costmap: updates obstacles
          â”‚   â”œâ”€ ML: runs inference
          â”‚   â””â”€ Color: detects colors
          â”‚
          â””â”€â†’ Behavior tree reads processed data
              â””â”€â†’ Makes decisions
                  â””â”€â†’ Loop continues!

NO HUMAN INTERVENTION! ğŸ‰
```

## ğŸ¯ Command Flow Example: "Navigate to Loading Bay"

```
1. Behavior Tree (Laptop)
   â†“
   behavior = MoveToPosition("ToLoadingBay", 0.3, 0.8)
   behavior.update()
   â†“

2. Check AMCL pose (Laptop)
   â†“
   current_pose = read /amcl_pose topic
   current_x = 0.0, current_y = 0.0
   â†“

3. Send goal to Nav2 (Laptop)
   â†“
   goal = NavigateToPose.Goal()
   goal.pose.position.x = 0.3
   goal.pose.position.y = 0.8
   send_goal_async(goal)
   â†“

4. Nav2 plans path (Laptop)
   â†“
   global_planner.plan(current_pose â†’ goal_pose)
   path = [(0.0,0.0), (0.1,0.2), (0.2,0.5), (0.3,0.8)]
   â†“

5. Nav2 executes path (Laptop)
   â†“
   controller.follow_path(path)
   â†“
   velocity = calculate_velocity(current_pose, next_waypoint)
   publish /cmd_vel {linear: 0.3, angular: 0.5}
   â†“

6. Arduino receives command (Pi)
   â†“
   receive /cmd_vel from network
   left_speed = (linear - angular * base_width/2)
   right_speed = (linear + angular * base_width/2)
   write to Arduino: "m 150 150"  # motor commands
   â†“

7. Robot moves (Pi hardware)
   â†“
   motors spin at commanded speeds
   encoders count ticks
   IMU measures rotation
   â†“

8. Arduino publishes odometry (Pi)
   â†“
   read encoder ticks: left=373, right=380
   calculate: dx, dy, dtheta
   publish /odom {x=0.05, y=0.02, theta=0.01}
   â†“

9. AMCL updates pose (Laptop)
   â†“
   receive /odom from network
   fuse with /scan data
   update particle filter
   publish /amcl_pose {x=0.05, y=0.02, ...}
   â†“

10. Behavior tree checks progress (Laptop)
    â†“
    distance = sqrt((0.3-0.05)Â² + (0.8-0.02)Â²) = 0.79m
    if distance < tolerance (0.2m):
        return SUCCESS
    else:
        return RUNNING
    â†“

11. Loop back to step 4
    (continues until distance < tolerance)
    â†“

12. Behavior returns SUCCESS
    â†“
    Move to next behavior in tree!
```

## ğŸ“Š Topic Bandwidth Estimate

```
PUBLISHED BY PI:
  /odom                    : ~50 Hz, ~1 KB/msg  = 50 KB/s
  /scan                    : ~10 Hz, ~5 KB/msg  = 50 KB/s
  /image_raw/compressed    : ~30 Hz, ~20 KB/msg = 600 KB/s
  /color_sensor/rgb        : ~5 Hz, ~0.1 KB/msg = 0.5 KB/s
  /tf                      : ~50 Hz, ~1 KB/msg  = 50 KB/s
                                         TOTAL  â‰ˆ 750 KB/s

PUBLISHED BY LAPTOP:
  /cmd_vel                 : ~20 Hz, ~0.2 KB/msg = 4 KB/s
  /camera_servo/command    : ~1 Hz, ~0.1 KB/msg  = 0.1 KB/s
  /conveyor/command        : ~1 Hz, ~0.1 KB/msg  = 0.1 KB/s
                                         TOTAL  â‰ˆ 4 KB/s

Network Load: ~754 KB/s â‰ˆ 6 Mbps (WiFi handles easily!)
```

## ğŸ Timeline: Full Mission Execution

```
Time    Pi Activity                Laptop Activity
â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
0:00    Publish sensors            Load map
0:01    Publish sensors            Start AMCL
0:02    Publish sensors            Wait for initial pose
0:05    Publish sensors            Initial pose set
                                   Behavior tree starts!

0:06    Receive /cmd_vel           Phase 1: Disease Detection
0:07    Move robot                 Navigate to plant
0:08    Publish /odom              Monitor progress
...
0:20    Capture image              ML inference running
0:21    Publish image              Result: "Healthy"
...
0:35    Receive /cmd_vel           Phase 2: Loading
0:36    Move backward              Reverse into bay
0:38    Read RGB sensor            Waiting for color
0:39    Publish RGB: "red"         Color detected!
...
0:50    Receive /cmd_vel           Phase 3: Maze
0:51    Move to red zone           Navigate + monitor camera
...
1:30    Capture image              Camera sees red marker
1:31    Publish image              Verify zone match!
...
1:45    Move backward              Phase 4: Delivery
1:47    Receive conveyor cmd       Reverse into bay
1:48    Activate conveyor          Activate conveyor
1:52    Cargo offloaded!           SUCCESS!
                                   MISSION COMPLETE! ğŸ‰

Total Time: ~2 minutes
```

---

**All diagrams show: Pi handles hardware, Laptop makes decisions!**
