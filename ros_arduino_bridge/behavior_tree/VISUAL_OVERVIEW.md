# Visual System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    COMPETITION MISSION SYSTEM                        â”‚
â”‚                      (Autonomous Robot)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HARDWARE LAYER                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Arduino  â”‚  â”‚  LiDAR   â”‚  â”‚ Pi Cam   â”‚  â”‚  Servos  â”‚           â”‚
â”‚  â”‚  + RGB   â”‚  â”‚ (SLAM)   â”‚  â”‚ (Color)  â”‚  â”‚Conveyor  â”‚           â”‚
â”‚  â”‚  Sensor  â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜           â”‚
â”‚       â”‚             â”‚             â”‚             â”‚                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚             â”‚             â”‚             â”‚
        â–¼             â–¼             â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ROS2 COMMUNICATION LAYER                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  /color_sensor/rgb        /scan              /camera/image_raw      â”‚
â”‚  /color_sensor/led        /map               /camera/color_detectionâ”‚
â”‚  /camera_servo/command    /amcl_pose         /inference_result      â”‚
â”‚  /tipper_servo/command    /cmd_vel           /stepper/command       â”‚
â”‚  /navigate_to_pose (Nav2 Action)                                    â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BEHAVIOR NODE LAYER (Your New Modular Nodes!)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ Color Sensor Nodes â”‚  â”‚  Camera Nodes      â”‚                    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
â”‚  â”‚ ReadColorSensor    â”‚  â”‚ MonitorCameraFor   â”‚                    â”‚
â”‚  â”‚ WaitForClear       â”‚  â”‚   Color            â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ VerifyColorMatch   â”‚                    â”‚
â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ Navigation Nodes   â”‚  â”‚ Motor Control      â”‚                    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
â”‚  â”‚ MoveToPosition     â”‚  â”‚ ActivateCamera     â”‚                    â”‚
â”‚  â”‚ ReverseDistance    â”‚  â”‚   Servo            â”‚                    â”‚
â”‚  â”‚ Turn180Degrees     â”‚  â”‚ ActivateTipper     â”‚                    â”‚
â”‚  â”‚ StopRobot          â”‚  â”‚   Servo            â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ ActivateConveyor   â”‚                    â”‚
â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚  â”‚ Disease Detection  â”‚                                             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                             â”‚
â”‚  â”‚ WaitForDisease     â”‚                                             â”‚
â”‚  â”‚   Detection        â”‚                                             â”‚
â”‚  â”‚ LogDiseaseResult   â”‚                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BEHAVIOR TREE LAYER (Mission Orchestration)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  CompetitionMission (Root Sequence)                                  â”‚
â”‚  â”‚                                                                    â”‚
â”‚  â”œâ”€ Phase 1: Disease Detection (Selector - can skip)                â”‚
â”‚  â”‚  â””â”€ Navigate â†’ Adjust Camera â†’ Detect â†’ Log â†’ Return            â”‚
â”‚  â”‚                                                                    â”‚
â”‚  â”œâ”€ Phase 2: Cargo Loading (Sequence)                               â”‚
â”‚  â”‚  â””â”€ Navigate â†’ Reverse In â†’ Read Color â†’ Exit                   â”‚
â”‚  â”‚                                                                    â”‚
â”‚  â”œâ”€ Phase 3: Maze Navigation (Sequence)                             â”‚
â”‚  â”‚  â””â”€ Enter Maze â†’ Navigate to Delivery (Selector)                â”‚
â”‚  â”‚     â”œâ”€ Red Branch â†’ Red Delivery Zone                           â”‚
â”‚  â”‚     â”œâ”€ Blue Branch â†’ Blue Delivery Zone                         â”‚
â”‚  â”‚     â”œâ”€ Green Branch â†’ Green Delivery Zone                       â”‚
â”‚  â”‚     â””â”€ Manual Fallback (always succeeds)                        â”‚
â”‚  â”‚                                                                    â”‚
â”‚  â””â”€ Phase 4: Cargo Delivery (Sequence)                              â”‚
â”‚     â””â”€ Verify Zone â†’ Turn 180Â° â†’ Reverse In â†’ Offload â†’ Exit      â”‚
â”‚        â””â”€ Offload with Retry:                                       â”‚
â”‚           â”œâ”€ Attempt 1: Conveyor only                              â”‚
â”‚           â””â”€ Attempt 2: Conveyor + Tipper (if needed)              â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  APPLICATION LAYER (What You Run)                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ competition_mission â”‚  â”‚ launch_competition  â”‚                  â”‚
â”‚  â”‚      .py            â”‚  â”‚       .py           â”‚                  â”‚
â”‚  â”‚                     â”‚  â”‚                     â”‚                  â”‚
â”‚  â”‚ Main mission file   â”‚  â”‚ Easy launcher with  â”‚                  â”‚
â”‚  â”‚ with all phases     â”‚  â”‚ prerequisite checks â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚  â”‚  test_behaviors.py  â”‚                                            â”‚
â”‚  â”‚                     â”‚                                            â”‚
â”‚  â”‚  Test individual    â”‚                                            â”‚
â”‚  â”‚  components         â”‚                                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        MISSION FLOW DIAGRAM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

START
  â”‚
  â”œâ”€ [Optional] Disease Detection Phase
  â”‚     â”‚
  â”‚     â”œâ”€â†’ Navigate to plant display
  â”‚     â”œâ”€â†’ Adjust camera servo (45Â°)
  â”‚     â”œâ”€â†’ Wait for ML classification
  â”‚     â”‚    â””â”€â†’ Timeout (15s) â†’ Manual observation
  â”‚     â”œâ”€â†’ Log result for judges
  â”‚     â””â”€â†’ Return to start
  â”‚
  â”œâ”€ Cargo Loading Phase
  â”‚     â”‚
  â”‚     â”œâ”€â†’ Navigate to loading bay
  â”‚     â”œâ”€â†’ Reverse into bay (0.5m)  â† REAR LOADING!
  â”‚     â”œâ”€â†’ Stop & wait (5s)
  â”‚     â”œâ”€â†’ Read color sensor
  â”‚     â”‚    â”œâ”€â†’ Success: Store color in blackboard
  â”‚     â”‚    â””â”€â†’ Timeout: Store 'unknown' â†’ Manual loading
  â”‚     â””â”€â†’ Exit bay (drive forward 0.5m)
  â”‚
  â”œâ”€ Maze Navigation Phase
  â”‚     â”‚
  â”‚     â”œâ”€â†’ Enter maze
  â”‚     â”‚
  â”‚     â””â”€â†’ Select delivery zone based on color:
  â”‚          â”‚
  â”‚          â”œâ”€â†’ [If RED] Navigate to red zone
  â”‚          â”‚    â””â”€â†’ Camera monitors for red during navigation
  â”‚          â”‚         â””â”€â†’ Stop when red detected
  â”‚          â”‚
  â”‚          â”œâ”€â†’ [If BLUE] Navigate to blue zone
  â”‚          â”‚    â””â”€â†’ Camera monitors for blue during navigation
  â”‚          â”‚         â””â”€â†’ Stop when blue detected
  â”‚          â”‚
  â”‚          â”œâ”€â†’ [If GREEN] Navigate to green zone
  â”‚          â”‚    â””â”€â†’ Camera monitors for green during navigation
  â”‚          â”‚         â””â”€â†’ Stop when green detected
  â”‚          â”‚
  â”‚          â””â”€â†’ [If UNKNOWN] Navigate to default zone
  â”‚               â””â”€â†’ Manual intervention expected
  â”‚
  â”‚          Note: Nav2 handles obstacle avoidance automatically!
  â”‚
  â””â”€ Cargo Delivery Phase
        â”‚
        â”œâ”€â†’ Verify at correct zone (camera check)
        â”‚    â”œâ”€â†’ Success: Continue
        â”‚    â””â”€â†’ Fail: Log error but continue (manual fix)
        â”‚
        â”œâ”€â†’ Turn 180Â° to face away from zone
        â”‚
        â”œâ”€â†’ Reverse into delivery bay (0.4m)
        â”‚
        â”œâ”€â†’ Offload cargo with retry:
        â”‚    â”‚
        â”‚    â”œâ”€â†’ Attempt 1: Activate conveyor (4s, speed=200)
        â”‚    â”œâ”€â†’ Check if cargo cleared (color sensor)
        â”‚    â”‚    â”œâ”€â†’ Clear: Success! â†’ Exit
        â”‚    â”‚    â””â”€â†’ Not clear: Continue to Attempt 2
        â”‚    â”‚
        â”‚    â”œâ”€â†’ Attempt 2: Activate tipper servo (90Â°) + conveyor (5s, speed=255)
        â”‚    â”œâ”€â†’ Check if cargo cleared
        â”‚    â”‚    â”œâ”€â†’ Clear: Success!
        â”‚    â”‚    â””â”€â†’ Not clear: Assume manual intervention
        â”‚    â”‚
        â”‚    â””â”€â†’ Reset tipper servo (170Â°)
        â”‚
        â”œâ”€â†’ Wait (2s)
        â”‚
        â””â”€â†’ Exit delivery bay (0.5m forward)

MISSION COMPLETE! ğŸ‰


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                      DATA FLOW DIAGRAM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Sensors â†’ ROS Topics â†’ Behavior Nodes â†’ Blackboard â†’ Mission Decisions

Example: Color-Based Delivery

  1. Color Sensor        â†’ /color_sensor/rgb
     (Hardware)             (ROS Topic)
                               â†“
  2. ReadColorSensor     â†’ Classify RGB
     (Behavior Node)        (red/blue/green/unknown)
                               â†“
  3. Blackboard          â†’ Store 'detected_color'
     (Shared Memory)        (e.g., 'red')
                               â†“
  4. CheckBlackboardColorâ†’ Compare with expected
     (Behavior Node)        (Is it 'red'?)
                               â†“
  5. Selector            â†’ Choose delivery zone
     (Tree Logic)           (Navigate to red zone)
                               â†“
  6. MoveToPosition      â†’ /navigate_to_pose action
     (Behavior Node)        (Nav2 navigation)
                               â†“
  7. Robot Arrives       â†’ Camera verifies color
     (Physical Movement)    (VerifyColorMatch node)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    FALLBACK MECHANISM DIAGRAM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Every critical operation has a backup plan:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SENSOR READING                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  Primary: Wait for sensor data (15s)                                â”‚
â”‚     â”‚                                                                 â”‚
â”‚     â”œâ”€â†’ Success â†’ Continue with data                                â”‚
â”‚     â”‚                                                                 â”‚
â”‚     â””â”€â†’ Timeout â†’ Store 'unknown' â†’ ALLOW MANUAL INTERVENTION       â”‚
â”‚         (Mission continues instead of failing)                       â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NAVIGATION                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  Primary: Nav2 path to goal                                         â”‚
â”‚     â”‚                                                                 â”‚
â”‚     â”œâ”€â†’ Obstacle detected â†’ Nav2 REPLANS AUTOMATICALLY              â”‚
â”‚     â”‚   (Dynamic costmap update, new path calculated)               â”‚
â”‚     â”‚                                                                 â”‚
â”‚     â””â”€â†’ Path blocked completely â†’ Nav2 reports failure              â”‚
â”‚         â†’ Behavior tree can retry or skip                           â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CARGO OFFLOAD                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  Attempt 1: Conveyor only (4s)                                      â”‚
â”‚     â”‚                                                                 â”‚
â”‚     â”œâ”€â†’ Check cleared (color sensor)                                â”‚
â”‚     â”‚    â”‚                                                            â”‚
â”‚     â”‚    â”œâ”€â†’ Success â†’ Done!                                        â”‚
â”‚     â”‚    â”‚                                                            â”‚
â”‚     â”‚    â””â”€â†’ Not cleared â†’ Try Attempt 2                            â”‚
â”‚     â”‚                                                                 â”‚
â”‚  Attempt 2: Conveyor + Tipper servo (5s)                            â”‚
â”‚     â”‚                                                                 â”‚
â”‚     â”œâ”€â†’ Check cleared                                               â”‚
â”‚     â”‚    â”‚                                                            â”‚
â”‚     â”‚    â”œâ”€â†’ Success â†’ Done!                                        â”‚
â”‚     â”‚    â”‚                                                            â”‚
â”‚     â”‚    â””â”€â†’ Not cleared â†’ ASSUME MANUAL FIX                        â”‚
â”‚     â”‚        (Mission continues)                                     â”‚
â”‚     â”‚                                                                 â”‚
â”‚     â””â”€â†’ Reset tipper servo                                          â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        FILE DEPENDENCIES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

competition_mission.py (Main File)
â”‚
â”œâ”€ Imports from: nodes/__init__.py
â”‚  â”‚
â”‚  â”œâ”€ color_sensor_behaviors.py
â”‚  â”‚  â””â”€ Uses: /color_sensor/rgb, /color_sensor/led topics
â”‚  â”‚
â”‚  â”œâ”€ camera_behaviors.py
â”‚  â”‚  â””â”€ Uses: /camera/color_detection topic
â”‚  â”‚
â”‚  â”œâ”€ disease_detection_behaviors.py
â”‚  â”‚  â””â”€ Uses: /inference_result topic
â”‚  â”‚
â”‚  â”œâ”€ navigation_behaviors.py
â”‚  â”‚  â””â”€ Uses: /cmd_vel, /navigate_to_pose action
â”‚  â”‚
â”‚  â””â”€ motor_control_behaviors.py
â”‚     â””â”€ Uses: /camera_servo/command, /tipper_servo/command,
â”‚               /stepper/command topics
â”‚
â””â”€ External Dependencies:
   â”œâ”€ py_trees (behavior tree library)
   â”œâ”€ py_trees_ros (ROS2 integration)
   â”œâ”€ rclpy (ROS2 Python client)
   â””â”€ Nav2 (navigation stack)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    TESTING WORKFLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Individual Component Testing (Bottom-Up)
â”‚
â”œâ”€ test_behaviors.py color_sensor
â”‚  â””â”€ Tests: ReadColorSensor node
â”‚     â””â”€ Verifies: RGB reading, color classification
â”‚
â”œâ”€ test_behaviors.py camera
â”‚  â””â”€ Tests: MonitorCameraForColor node
â”‚     â””â”€ Verifies: Camera detection, color matching
â”‚
â”œâ”€ test_behaviors.py motors
â”‚  â””â”€ Tests: All servo and conveyor nodes
â”‚     â””â”€ Verifies: Servo movements, conveyor activation
â”‚
â”œâ”€ test_behaviors.py navigation
â”‚  â””â”€ Tests: Movement behaviors
â”‚     â””â”€ Verifies: Forward, reverse, turn movements
â”‚
â””â”€ test_behaviors.py disease
   â””â”€ Tests: Disease detection workflow
      â””â”€ Verifies: ML model integration

Integration Testing (Top-Down)
â”‚
â”œâ”€ launch_competition.py --dry-run
â”‚  â””â”€ Validates: Tree structure, no execution
â”‚
â”œâ”€ Test Phase by Phase
â”‚  â”œâ”€ Phase 1 only (disease detection)
â”‚  â”œâ”€ Phase 2 only (cargo loading)
â”‚  â”œâ”€ Phase 3 only (maze navigation)
â”‚  â””â”€ Phase 4 only (cargo delivery)
â”‚
â””â”€ Full Mission Rehearsal
   â””â”€ launch_competition.py
      â””â”€ Monitors: All phases, timing, performance


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Created: October 7, 2025
Status: READY FOR COMPETITION! ğŸ†
```
